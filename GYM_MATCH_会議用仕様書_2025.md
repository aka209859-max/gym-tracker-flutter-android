# GYM MATCH - 会議用新仕様書

**作成日**: 2025-11-28  
**バージョン**: v1.0.99 (iOS審査提出済み)  
**対象プラットフォーム**: iOS専用  
**App Store ID**: 6755346813  
**App Store URL**: https://apps.apple.com/jp/app/gym-match/id6755346813  
**GitHub リポジトリ**: https://github.com/aka209859-max/gym-tracker-flutter

---

## 📱 アプリ概要

**GYM MATCH（ジムマッチ）**は、全国のジム検索・リアルタイム混雑度表示・トレーニング記録管理・AI分析を統合した総合フィットネスアプリです。

### コアコンセプト
> **「混雑を避けて、効率的にトレーニング。AI が最適なメニューを提案。」**

- 🗺️ **全国ジム検索** - Google Places API連携で全国の最新ジム情報
- 📊 **リアルタイム混雑度** - ユーザーレポートベースの混雑状況可視化
- 📝 **詳細トレーニング記録** - セット・重量・回数・RPEを完全記録
- 🤖 **AI トレーニングコーチ** - Google Gemini 2.0 Flash によるパーソナライズされたメニュー提案
- 👥 **パートナーマッチング** - 同じ目標を持つトレーニング仲間の検索（Proプラン）

---

## 🎯 主要機能と使用シーン

### 1. 🗺️ ジム検索・混雑度表示

#### **機能概要**
GPS位置情報とGoogle Maps連携で、現在地周辺のジムをリアルタイム混雑度付きで検索・表示。

#### **ユーザーの使用シーン**
- **シーン1: 出張先・旅行先でのジム探し**
  - 「出張で大阪にいるけど、今日トレーニングできるジムはあるかな？」
  - → アプリを開いてGPS検索、近くのジムを混雑度付きで一覧表示
  
- **シーン2: 混雑を避けたい時**
  - 「仕事帰りにジムに行きたいけど、混んでたら嫌だな」
  - → 事前に混雑度をチェック、空いている時間を狙って訪問
  
- **シーン3: ジムの設備確認**
  - 「このジムにはパワーラックがあるかな？シャワーは？」
  - → ジム詳細画面で設備情報・写真・口コミを確認

#### **主要機能詳細**
- **リアルタイム混雑度表示（5段階）**
  - 空いている 🟢 → やや混雑 🟡 → 混雑 🟠 → 非常に混雑 🔴
  - ユーザーレポート（24時間有効）を最優先
  - 統計データから推定混雑度を算出
  
- **ジム詳細情報**
  - 営業時間・定休日・電話番号・住所
  - 設備情報（フリーウェイト・マシン・有酸素・シャワー等）
  - 写真ギャラリー
  - Google Maps連携（ルート検索ワンタップ）
  
- **お気に入り登録（Premium以上）**
  - よく行くジムをブックマーク
  - お気に入り一覧から素早くアクセス

---

### 2. 📝 トレーニング記録管理

#### **機能概要**
日々のトレーニングを詳細に記録し、成長を可視化。カレンダービューで過去の記録を一目で確認。

#### **ユーザーの使用シーン**
- **シーン1: トレーニング直後の記録**
  - 「今日のベンチプレスは80kg×8reps×3setだった」
  - → 種目・重量・回数・セット数を即座に入力、カレンダーに記録
  
- **シーン2: 成長の確認**
  - 「先月と比べてどれくらい成長したかな？」
  - → 統計ダッシュボードで週次・月次の総挙上重量を確認
  
- **シーン3: パーソナルレコード（PR）更新**
  - 「今日はデッドリフト150kg成功！自己ベスト更新！」
  - → 自動的にPRが更新され、達成バッジを獲得

#### **主要機能詳細**
- **詳細記録機能**
  - 種目・重量・回数・セット数
  - RPE（主観的運動強度 1～10）
  - セットタイプ（通常・ウォームアップ・ドロップセット・スーパーセット）
  - メモ機能（フォーム意識・体調等）
  
- **カレンダービュー**
  - 月間カレンダーでトレーニング日を視覚化
  - トレーニング日にマーク表示
  - 日付選択で当日の詳細記録を表示
  
- **統計ダッシュボード**
  - 7日間総挙上重量
  - 今月総挙上重量
  - 全期間総挙上重量
  - 月間ワークアウト日数
  
- **テンプレート機能**
  - よく行うメニューを保存
  - 保存したテンプレートをワンタップで適用
  
- **CSV インポート/エクスポート**
  - 他アプリからのデータ移行
  - バックアップ作成

---

### 3. 🤖 AI トレーニングコーチング

#### **機能概要**
Google Gemini 2.0 Flash AI を搭載し、ユーザーの目標・経験レベルに応じた最適なトレーニングメニューを自動生成。

#### **ユーザーの使用シーン**
- **シーン1: 何をすればいいか迷った時**
  - 「今日は胸を鍛えたいけど、どんなメニューがいいかな？」
  - → AIコーチに「胸」を選択、初心者/中級者モードで最適メニューを提案
  
- **シーン2: マンネリ打破**
  - 「いつも同じメニューで飽きてきた」
  - → AIが新しい種目・セット構成を提案、トレーニングに変化を
  
- **シーン3: 初心者のフォーム学習**
  - 「ベンチプレスの正しいフォームが知りたい」
  - → AIが初心者モードで安全なフォーム解説付きメニューを提案

#### **主要機能詳細**
- **部位別メニュー生成**
  - 胸・背中・脚・肩・腕（二頭筋・三頭筋）・体幹・有酸素
  
- **レベル別カスタマイズ**
  - **初心者モード**: フォーム重視、安全な種目選定
  - **中級者モード**: ボリューム重視、複合種目中心
  - **上級者モード**: 高強度、ドロップセット・スーパーセット推奨
  
- **メニュー保存・履歴管理**
  - 生成したメニューをテンプレート保存
  - 過去の提案メニューを確認
  
- **AI 使用回数制限**（プラン別）
  - **無料プラン**: リワード広告視聴で月3回まで
  - **Premium プラン**: 月10回
  - **Pro プラン**: 月30回
  - **追加購入**: ¥300で5回追加（全ユーザー対象）

---

### 4. 📊 AI 成長予測・効果分析

#### **機能概要**（Premium以上）
トレーニングデータを分析し、AI が今後の筋力成長を予測。週次レポートで改善点を提案。

#### **ユーザーの使用シーン**
- **シーン1: モチベーション維持**
  - 「このペースで続けたら、3ヶ月後にベンチプレス100kg達成できるかな？」
  - → AI が過去のデータから成長曲線を予測、目標達成時期を提示
  
- **シーン2: トレーニング効果の確認**
  - 「今週のトレーニング、ちゃんと効果出てるかな？」
  - → 週次レポートで総挙上重量・部位別分析・前週比較を自動生成
  
- **シーン3: オーバートレーニング防止**
  - 「最近疲れが抜けないな…」
  - → 疲労管理システムが部位別疲労度を計算、休息を推奨

#### **主要機能詳細**
- **1RM 予測**
  - 現在の記録から理論的最大挙上重量を算出
  
- **成長曲線予測**
  - 今後の筋力成長トレンドを予測
  - 個人要因（年齢・経験年数・睡眠・栄養・飲酒）で補正
  
- **週次レポート自動生成**
  - 週間総挙上重量
  - 部位別トレーニング量分析
  - 前週比較・変化率
  - AI による改善提案
  
- **疲労管理システム**
  - トレーニング量から疲労度を自動計算
  - 部位別疲労度の可視化
  - オーバートレーニング警告

---

### 5. 🧮 計算ツール（全プラン共通）

#### **機能概要**
トレーニングに役立つ各種計算ツールを搭載。

#### **ユーザーの使用シーン**
- **シーン1: 1RM（最大挙上重量）の確認**
  - 「80kg×8reps できたから、俺の1RMはいくつだろう？」
  - → RM計算機で約100kg と算出
  
- **シーン2: 適切な重量の選定**
  - 「今日は筋肥大目的で70%1RMでやりたい」
  - → 100kg × 0.7 = 70kg と自動計算、推奨重量を提示
  
- **シーン3: 減量・増量のカロリー計算**
  - 「減量するには1日何kcal摂ればいい？」
  - → TDEE 計算で基礎代謝・活動量から推奨摂取カロリーを算出

#### **主要機能詳細**
- **RM 計算機**
  - 1RM（最大挙上重量）計算
  - 複数公式対応（Epley・Brzycki・Lander）
  - %1RM 逆算（目標%から使用重量を算出）
  
- **体組成計算機**
  - BMI 計算
  - 体脂肪率推定
  - 除脂肪体重算出
  
- **カロリー計算機**
  - TDEE（総消費カロリー）計算
  - 目標別推奨カロリー（減量・維持・増量）

---

### 6. 👥 トレーニングパートナー検索（Proプラン）

#### **機能概要**
同じ目標を持つトレーニング仲間をマッチング。位置情報・目標・経験レベルでフィルター検索。

#### **ユーザーの使用シーン**
- **シーン1: トレーニング仲間が欲しい**
  - 「一人でトレーニングするのは寂しい、仲間が欲しい」
  - → パートナー検索で近くのユーザーを表示、プロフィール確認後にリクエスト送信
  
- **シーン2: 同じ目標の仲間と切磋琢磨**
  - 「ベンチプレス100kg 目指している人と一緒にトレーニングしたい」
  - → 目標・経験レベルでフィルター、同じ目標の仲間を発見
  
- **シーン3: メッセージで日程調整**
  - 「今週末一緒にトレーニングしませんか？」
  - → メッセージング機能で日時・場所を相談

#### **主要機能詳細**
- **条件検索**
  - 距離（現在地から〇km 圏内）
  - トレーニング目標（筋肥大・筋力向上・減量等）
  - 経験レベル（初心者・中級者・上級者）
  - 性別・年齢・よく行く曜日・時間帯
  
- **メッセージング機能**
  - 1対1チャット
  - リアルタイム更新
  - チャットルーム一覧
  
- **フレンドリクエスト**
  - リクエスト送信・受信
  - 承認・拒否機能

---

### 7. 🏅 目標・達成管理（全プラン共通）

#### **機能概要**
目標体重・種目別目標重量を設定し、達成時にバッジを獲得。

#### **ユーザーの使用シーン**
- **シーン1: 目標設定でモチベーション向上**
  - 「3ヶ月後までにベンチプレス100kg 達成したい」
  - → 目標設定画面で目標重量・期限を登録
  
- **シーン2: 達成時の喜び**
  - 「やった！ベンチプレス100kg 達成！」
  - → 自動的に目標達成バッジを獲得、達成通知

#### **主要機能詳細**
- **目標設定**
  - 体重目標（目標体重・期限）
  - 種目別目標（各種目の目標重量）
  
- **達成バッジシステム**
  - 継続バッジ（連続記録日数）
  - ボリュームバッジ（総挙上重量）
  - PR達成バッジ（自己記録更新）
  - 種目別バッジ

---

## 💻 技術スタック

### **フロントエンド**
| カテゴリ | 技術 | バージョン |
|----------|------|------------|
| **開発言語** | Dart | 3.5.0+ |
| **フレームワーク** | Flutter | 3.35.4 |
| **状態管理** | Provider | 6.1.5 |
| **UI ライブラリ** | Material Design 3 | Flutter標準 |

### **バックエンド・データベース**
| カテゴリ | 技術 | 用途 |
|----------|------|------|
| **データベース** | Firebase Firestore | メインデータストア（22コレクション）|
| **認証** | Firebase Authentication | 匿名ログイン・パスワード認証 |
| **ストレージ** | Firebase Storage | 画像・ファイル保存 |
| **ローカルDB** | Hive | オフラインキャッシュ |
| **ローカル設定** | SharedPreferences | AI使用回数・プラン情報キャッシュ |

### **外部API連携**
| サービス | 用途 | 詳細 |
|----------|------|------|
| **Google Places API** | ジム検索 | 全国のジム情報取得 |
| **Google Maps API** | 地図表示 | ジム位置のマップ表示・ルート検索 |
| **Google Gemini 2.0 Flash** | AI コーチング | トレーニングメニュー生成・成長予測・効果分析 |
| **RevenueCat** | iOS 課金管理 | サブスクリプション・消耗型課金の管理 |
| **Google AdMob** | 広告配信 | 無料プランのマネタイズ（バナー・リワード広告）|

### **主要パッケージ**
```yaml
dependencies:
  # Firebase
  firebase_core: 3.6.0
  cloud_firestore: 5.4.3
  firebase_auth: 5.3.1
  firebase_storage: 12.3.2
  
  # Google Maps
  google_maps_flutter: 2.10.0
  geolocator: 13.0.2
  geocoding: 3.0.0
  
  # 状態管理・ユーティリティ
  provider: 6.1.5+1
  http: 1.5.0
  intl: 0.20.2
  
  # ローカルストレージ
  shared_preferences: 2.5.3
  hive: 2.2.3
  hive_flutter: 1.1.0
  
  # UI 強化
  fl_chart: ^0.69.0           # グラフ表示
  table_calendar: ^3.1.2      # カレンダーウィジェット
  cached_network_image: ^3.4.1 # 画像キャッシュ
  image_picker: ^1.1.2        # 画像選択
  
  # SNS シェア
  screenshot: ^3.0.0          # Widget to Image
  share_plus: ^10.1.3         # SNS シェア
  
  # 課金・広告
  purchases_flutter: ^8.11.0  # RevenueCat SDK
  google_mobile_ads: 5.3.1    # AdMob SDK
  app_tracking_transparency: ^2.0.6 # iOS トラッキング許可
```

### **開発ツール・CI/CD**
| ツール | 用途 |
|--------|------|
| **GitHub Actions** | 自動ビルド・デプロイ |
| **Xcode** | iOS ビルド（v15.0+） |
| **CocoaPods** | iOS 依存関係管理 |

### **Firestore データ構造（22コレクション）**
```
gyms/                    # ジム情報
users/                   # ユーザープロファイル
workout_logs/            # トレーニング記録
personal_records/        # パーソナルレコード
weekly_reports/          # 週次レポート
goals/                   # 目標
achievements/            # 達成バッジ
crowd_reports/           # 混雑度レポート
reviews/                 # ジムレビュー
favorites/               # お気に入り
training_partners/       # トレーニングパートナー
chat_rooms/              # チャットルーム
chat_messages/           # チャットメッセージ
friend_requests/         # フレンドリクエスト
gym_announcements/       # ジムお知らせ
partner_profiles/        # パートナージムプロファイル
pt_members/              # PT会員
pt_sessions/             # PTセッション
campaign_applications/   # キャンペーン応募
notifications/           # 通知
partner_access/          # パートナーアクセス記録
reservations/            # 予約
```

---

## 💰 料金プラン詳細

### 📊 プラン比較表

| 機能 | 無料 | Premium | Pro |
|------|------|---------|-----|
| **月額料金** | ¥0 | ¥500/月<br>¥4,800/年 | ¥980/月<br>¥8,000/年 |
| **無料トライアル** | - | 30日間 | 14日間 |
| **ジム検索** | ✅ | ✅ | ✅ |
| **GPS 位置検索** | ✅ | ✅ | ✅ |
| **混雑度表示** | ✅ | ✅ | ✅ |
| **トレーニング記録** | ✅ | ✅ | ✅ |
| **お気に入り保存** | ⚠️ 制限あり | ✅ 無制限 | ✅ 無制限 |
| **AI 機能** | ⚠️ 広告視聴で月3回 | ✅ 月10回 | ✅ 月30回 |
| **レビュー投稿** | ❌ | ✅ | ✅ |
| **混雑度アラート** | ❌ | ✅ | ✅ |
| **パートナー検索** | ❌ | ❌ | ✅ |
| **メッセージング** | ❌ | ❌ | ✅ |
| **広告表示** | ⚠️ あり | ✅ なし | ✅ なし |

---

### 🆓 無料プラン（¥0 / 永久無料）

#### **利用可能機能**
- ✅ 全国のジム検索（Google Places API）
- ✅ GPS 位置検索
- ✅ リアルタイム混雑度表示
- ✅ 営業時間・設備情報の閲覧
- ✅ 基本トレーニング記録
- ✅ カレンダービュー
- ✅ 統計ダッシュボード
- ✅ 計算ツール（RM・BMI・TDEE）
- ✅ 目標設定・達成バッジ
- ✅ AI 機能（リワード広告視聴で月3回まで）

#### **制限事項**
- ⚠️ **お気に入り保存**: 制限あり
- ⚠️ **AI 機能**: リワード広告視聴必須（月3回まで）
- ⚠️ **広告表示**: バナー広告・インタースティシャル広告あり
- ❌ **レビュー投稿**: 不可
- ❌ **パートナー検索**: 不可

#### **マネタイズ戦略**
- **バナー広告**: ホーム画面下部に常時表示
- **リワード広告**: AI 機能使用のために視聴
- **アップグレード誘導**: Premium/Pro プランへの自然な誘導

---

### 💎 Premium プラン

#### **料金体系**
| 期間 | 料金 | 月換算 | 割引率 | 年間節約額 |
|------|------|--------|--------|------------|
| **月額** | ¥500/月 | ¥500/月 | - | - |
| **年額** | ¥4,800/年 | ¥400/月 | **20% OFF** | **¥1,200お得** |

#### **無料トライアル**
- **期間**: 30日間
- **特典**: 全 Premium 機能を無料体験
- **自動更新**: トライアル終了後、自動的に有料プランに移行
- **キャンセル**: いつでも可能（期間満了まで利用可）

#### **利用可能機能**
- ✨ **無料プランの全機能**
- 🤖 **AI 機能 月10回**（コーチング・成長予測・効果分析）
- ❤️ **お気に入り無制限**
- 📊 **詳細な混雑度統計**
- 🔔 **混雑度アラート通知**
- 📝 **ジムレビュー投稿**
- 🎯 **高度なフィルター検索**
- 🚫 **広告なし**

#### **想定ユーザー**
- 週2～3回ジムに通うユーザー
- AI コーチングを定期的に活用したいユーザー
- 広告を非表示にしたいユーザー
- 複数のジムをお気に入り登録したいユーザー

---

### 🌟 Pro プラン

#### **料金体系**
| 期間 | 料金 | 月換算 | 割引率 | 年間節約額 |
|------|------|--------|--------|------------|
| **月額** | ¥980/月 | ¥980/月 | - | - |
| **年額** | ¥8,000/年 | ¥667/月 | **32% OFF** | **¥3,760お得** |

#### **無料トライアル**
- **期間**: 14日間
- **特典**: 全 Pro 機能を無料体験
- **自動更新**: トライアル終了後、自動的に有料プランに移行
- **キャンセル**: いつでも可能（期間満了まで利用可）

#### **利用可能機能**
- ✨ **Premium プランの全機能**
- 🤖 **AI 機能 月30回**（コーチング・成長予測・効果分析）
- 👥 **トレーニングパートナー検索**
- 💬 **メッセージング機能**
- 🤝 **フレンドリクエスト**
- 📊 **トレーニング記録の共有（予定）**

#### **想定ユーザー**
- 週4回以上ジムに通うヘビーユーザー
- AI 機能をフル活用したいユーザー
- トレーニング仲間を探しているユーザー
- 本格的なトレーニング管理を行いたいユーザー

---

### 🎁 AI 追加パック（全ユーザー対象）

#### **料金・内容**
- **価格**: **¥300 / 5回**
- **単価**: ¥60/回
- **対象**: 全ユーザー（無料・Premium・Pro 問わず）
- **有効期限**: 今月末まで（月次リセット）
- **Product ID**: `com.nexa.gymmatch.ai_pack_5_v2`

#### **購入条件**
- **無料プラン**: AI クレジット（広告視聴分）が0のとき購入可能
- **有料プラン**: 月間 AI 使用回数が上限に達したとき購入可能

#### **使用優先順位**
1. **有料プラン**
   - Step 1: 基本 AI 使用回数を消費（Premium 10回 / Pro 30回）
   - Step 2: AI 追加パックを消費
   
2. **無料プラン**
   - Step 1: AI 追加パックを消費
   - Step 2: AI クレジット（広告視聴分）を消費

#### **戦略的位置づけ**
- 有料プラン会員の**追加収益源**
- 無料プランユーザーの**課金体験の入り口**
- 月次リセットによる**定期収益の確保**

---

### 💳 RevenueCat Product IDs

#### **サブスクリプション（月額）**
- Premium 月額: `com.nexa.gymmatch.premium.monthly`
- Pro 月額: `com.nexa.gymmatch.pro.monthly`

#### **サブスクリプション（年額）**
- Premium 年額: `com.nexa.gymmatch.premium.annual`
- Pro 年額: `com.nexa.gymmatch.pro.annual`

#### **消耗型（Consumable）**
- AI 追加パック: `com.nexa.gymmatch.ai_pack_5_v2`

---

### 📊 料金戦略サマリー

#### **年額選択率向上施策**
1. ✅ **デフォルト選択**: 年額をデフォルト選択
2. ✅ **大幅割引**: Premium 20% OFF、Pro 32% OFF
3. ✅ **強調表示**: 「💥お得」バッジと節約金額表示
4. ✅ **月換算表示**: 年額の月換算価格を明示

#### **マネタイズ多層化**
1. **無料プラン**: 広告収益（AdMob）
2. **Premium プラン**: サブスクリプション収益（¥500/月 or ¥4,800/年）
3. **Pro プラン**: サブスクリプション収益（¥980/月 or ¥8,000/年）
4. **AI 追加パック**: 追加課金収益（¥300/5回）

#### **LTV（顧客生涯価値）最大化**
- 無料プラン → Premium（¥4,800/年）→ Pro（¥8,000/年）へのアップグレードパス
- AI 追加パック購入による追加収益
- 年額プランによる長期契約・解約率低減

---

## 📈 ビジネスモデル

### **収益源**
1. **サブスクリプション収益**（主収益）
   - Premium プラン: ¥500/月 or ¥4,800/年
   - Pro プラン: ¥980/月 or ¥8,000/年
   
2. **広告収益**（無料プラン）
   - バナー広告（ホーム画面）
   - リワード広告（AI 機能使用）
   
3. **追加課金収益**
   - AI 追加パック: ¥300/5回

### **ターゲット市場**
- **プライマリ**: 筋トレ・ボディメイクに取り組む20～40代
- **セカンダリ**: ジム初心者・中級者
- **ジオグラフィック**: 日本全国（iOS ユーザー）

### **競合優位性**
1. ✅ **リアルタイム混雑度表示**（他アプリにない独自機能）
2. ✅ **AI コーチング**（Google Gemini 2.0 Flash 搭載）
3. ✅ **詳細トレーニング記録**（RPE・セットタイプ等）
4. ✅ **パートナーマッチング**（Pro プラン限定）
5. ✅ **全国ジム検索**（Google Places API 連携）

---

## 🎯 今後の展開

### **短期（3ヶ月）**
- ✅ iOS App Store リリース（完了）
- 🔄 AdMob 広告配信開始（テスト中）
- 🔄 TestFlight テスト・フィードバック収集
- 📢 マーケティング開始（SNS・ブログ等）

### **中期（6ヶ月）**
- 📱 プッシュ通知実装
- 🔐 ユーザーデータ削除機能（GDPR 対応）
- 📊 データバックアップ・復元機能
- 🎥 動画フォームチェック機能（予定）

### **長期（1年）**
- 🤖 Android版リリース
- 🌍 多言語対応（英語・中国語）
- ⌚ Apple Watch 対応
- 🔗 ウェアラブルデバイス連携
- 🍎 栄養管理機能

---

## 📞 お問い合わせ

**開発元**: NEXA  
**アプリ名**: GYM MATCH  
**App Store**: https://apps.apple.com/jp/app/gym-match/id6755346813  
**GitHub**: https://github.com/aka209859-max/gym-tracker-flutter  
**お問い合わせ**: アプリ内「設定」→「お問い合わせ」

---

## 📝 補足資料

### **詳細ドキュメント**
- `GYM_MATCH_USER_SPEC.md` - ユーザー向け仕様書
- `GYM_MATCH_全機能一覧.md` - 全機能の詳細一覧（80以上の画面）
- `AI使用回数管理_最新仕様.md` - AI 機能の詳細仕様
- `COMPLETE_FIX_SUMMARY_OPTION1-4.md` - 最新バグ修正サマリー
- `OPTION4_DETAILED_INVESTIGATION_REPORT.md` - 詳細調査レポート

### **技術ドキュメント**
- `README.md` - プロジェクト概要・セットアップ手順
- `ios/Runner/Info.plist` - iOS 設定
- `pubspec.yaml` - パッケージ依存関係

---

**GYM MATCH - あなたのジムライフを、もっと快適に、もっと効率的に。**

---

**作成日**: 2025-11-28  
**バージョン**: v1.0.99  
**ドキュメント種別**: 会議用新仕様書  
**対象**: 経営陣・投資家・ビジネスパートナー向け
